@model AS_CRM.PSprint

@{
    ViewBag.Title = "Details";
}

<div class="row">
    <h2 class="col-md-11">Sprint @Model.Nombre - del @Model.FechaIncio al @Model.FechaIncio</h2>
    @Html.ActionLink("Vover", "Index", null, new { @class = "col-md-1 btn btn-info", @style = "margin-top:15px;" })
</div>


<div>
    <hr />
    <div class="container-fluid">
        <div class="row">

            @foreach (var _e in (ViewData["estados"] as IList<PEstado>))
            {
                <div class="col-md-2" style=" height:40px; align-items:center; border-bottom:7px solid @_e.Color; border-radius:1px;">
                    <h4 style="text-align:center; height:10px;margin-top:6px;">@_e.Nombre</h4>
                </div>
            }
            @foreach (var _e in (ViewData["estados"] as IList<PEstado>))
            {
                <div class="col-md-2 " style="border-right:5px solid white; height:70vh; align-items:center; background-color:white; overflow-y:auto; padding-top:20px;">
                    @if (ViewBag.userfilter == true)
                    {
                        foreach (var _t in Model.PTareas.Where(w => w.Estado_Id == _e.Id).OrderBy(o => o.FechaEntrega).ToList().OrderBy(p => p.PPrioridade.Orden))
                        {
                            <div style="border: 1px solid #dcdbdb; background-color: @_e.Color; border-radius: 5px;  height:120px;font-size:9pt;  ">
                                <div class="bold overflow-ellipsis" style="padding-left: 5px; border-bottom: 1px solid #c7c4c4; background-color: #e8e5e5; margin-top: 0px; height:24px;">
                                    <span>
                                        <img src="~/Content/image/@_t.PObjetivo.Proyecto.logo" class=" img-circle" style="width: 20px; height: 20px; margin-top: 0px; " />
                                    </span>
                                    <span>
                                        <a class="btn-grid" href="@Url.Action("EditModal", "PTareas", new { id = _t.Id })"><span>@_t.Id - @_t.Nombre </span></a>
                                    </span>
                                </div>
                                <div style="border-bottom: 1px solid #686363; padding-left: 5px;padding-top:5px; height:80px;">
                                    <div class="card-text bold">Prioridad: @_t.PPrioridade.Nombre</div>
                                    <div class="card-text bold">Asignado A: @_t.AspNetUser.Email.Split(char.Parse("@"))[0]</div>
                                    <div class="card-header"><sapm class="bold">Inicio:</sapm> @_t.FechaIncio.Value.Date.ToShortDateString()</div>
                                    <div class="card-header"><sapm class="bold">Entrega:</sapm> @_t.FechaEntrega.Value.Date.ToShortDateString()</div>
                                </div>
                                <div class="bold" style="padding-left:5px; border-bottom:1px solid #c7c4c4;height:22px; background-color:#e8e5e5; margin-bottom:0px;">
                                    <span><a class="btn-grid" href="@Url.Action("EditModal", "PTareas", new { id = _t.Id }) "><img src="~/Content/image/iconos_Buscar.png" style="width:16px; height:16px;" /></a></span>
                                    <span><a class="btn-grid" href="@Url.Action("CreateParteHoras", "PPartehoras", new { idt = _t.Id }) "><img src="~/Content/image/iconos_Reloj.png" style="width:16px; height:16px;" /></a></span>
                                </div>
                            </div>
                            <br />
                        }
                    }
                    else
                    {
                        foreach (var _t in Model.PTareas.Where(w => w.Estado_Id == _e.Id && w.AspNetUser.Email == User.Identity.Name).OrderBy(o => o.FechaEntrega).ToList().OrderBy(p => p.PPrioridade.Orden))
                        {
                            <div style="border: 1px solid #dcdbdb; background-color: @_e.Color; border-radius: 5px;  height:120px;font-size:9pt;  ">
                                <div class="bold overflow-ellipsis" style="padding-left: 5px; border-bottom: 1px solid #c7c4c4; background-color: #e8e5e5; margin-top: 0px; height:24px;">
                                    <span>
                                        <img src="~/Content/image/@_t.PObjetivo.Proyecto.logo" class=" img-circle" style="width: 20px; height: 20px; margin-top: 0px; " />
                                    </span>
                                    <span>
                                        <a class="btn-grid" href="@Url.Action("EditModal", "PTareas", new { id = _t.Id })"><span>@_t.Id - @_t.Nombre </span></a>
                                    </span>
                                </div>
                                <div style="border-bottom: 1px solid #686363; padding-left: 5px;padding-top:5px; height:80px;">
                                    <div class="card-text bold">Prioridad: @_t.PPrioridade.Nombre</div>
                                    <div class="card-text bold">Asignado A: @_t.AspNetUser.Email.Split(char.Parse("@"))[0]</div>
                                    <div class="card-header"><sapm class="bold">Inicio:</sapm> @_t.FechaIncio.Value.Date.ToShortDateString()</div>
                                    <div class="card-header"><sapm class="bold">Entrega:</sapm> @_t.FechaEntrega.Value.Date.ToShortDateString()</div>
                                </div>
                                <div class="bold" style="padding-left:5px; border-bottom:1px solid #c7c4c4;height:22px; background-color:#e8e5e5; margin-bottom:0px;">
                                    <span><a class="btn-grid" href="@Url.Action("EditModal", "PTareas", new { id = _t.Id }) "><img src="~/Content/image/iconos_Buscar.png" style="width:16px; height:16px;" /></a></span>
                                    <span><a class="btn-grid" href="@Url.Action("CreateParteHoras", "PPartehoras", new { idt = _t.Id }) "><img src="~/Content/image/iconos_Link 2.png" style="width:16px; height:16px;" /></a></span>
                                </div>
                            </div>
                            <br />
                        }
                    }
                </div>
            }
        </div>
    </div>

</div>
